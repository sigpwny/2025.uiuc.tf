import{p as Se,i as St,a as x,l as At}from"./props.Cnc7M2bm.js";import{o as Xt}from"./index-client.qxHWBHhE.js";import{ak as ea,n as fa,at as pa,au as ma,p as Nt,e as f,t as b,av as ta,i as a,h as l,r,g as t,b as v,d as Tt,o as $t,s as e,m as s,f as Pt,x as dt,l as aa,aj as Zt,a as ra,c as ba}from"./template.BGKbqTa9.js";import{n as Gt}from"./router.DnZMHVsn.js";import{s as Ae,a as _a,l as wa,r as xa,g as Kt}from"./ctfd.svelte.CqsomuiX.js";import{s as _}from"./render.92hFe8tD.js";import{c as Rt,b as zt,r as oe,d as ga}from"./attributes.BncxncTT.js";import{l as ha,e as ue}from"./utils.D9RhwMV2.js";import{b as ne}from"./input.G2Gi3XL0.js";import{p as Qt}from"./event-modifiers.CdEA5IGF.js";import{e as la,i as ya}from"./each.C28cXzkQ.js";import{c as Ca,T as Ea}from"./TeamInfo.C7h2oHWs.js";import{P as ia}from"./PixelarticonsAlert.CNJoCIHu.js";import{P as sa}from"./PixelarticonsCheck.CnPeWgZw.js";import"./Timestamp.DhBJlai7.js";import"./PixelarticonsZap.BL3WYaLL.js";import"./PixelarticonsFlag.CyhA6Uz-.js";import"./PixelarticonsTrophy.DgTKQV-n.js";import"./PixelarticonsExternalLink.D30IX11u.js";import"./SvgSpinners270Ring.DBi1DYLx.js";function oa(p,g,n){if(p.multiple)return g==null?void 0:fa(g)?Pa(p,g):pa();for(var h of p.options){var o=ht(h);if(ma(o,g)){h.selected=!0;return}}(!n||g!==void 0)&&(p.selectedIndex=-1)}function ka(p,g){ea(()=>{var n=new MutationObserver(()=>{var h=p.__value;oa(p,h)});return n.observe(p,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{n.disconnect()}})}function na(p,g,n=g){var h=!0;ha(p,"change",o=>{var k=o?"[selected]":":checked",N;if(p.multiple)N=[].map.call(p.querySelectorAll(k),ht);else{var q=p.querySelector(k)??p.querySelector("option:not([disabled])");N=q&&ht(q)}n(N)}),ea(()=>{var o=g();if(oa(p,o,h),h&&o===void 0){var k=p.querySelector(":checked");k!==null&&(o=ht(k),n(o))}p.__value=o,h=!1}),ka(p)}function Pa(p,g){for(var n of p.options)n.selected=g.includes(ht(n))}function ht(p){return"__value"in p?p.__value:p.value}var Sa=f("<option> </option>"),Aa=f("<option disabled> </option>"),Na=f("<option> </option>"),Ta=f('<select class="block w-full mt-1 border bg-surface-100 text-text border-surface-300 px-3 py-2 text-sm"><!><!></select>');function da(p,g){Nt(g,!1);let n=Se(g,"value",12,""),h=Se(g,"name",8,"country"),o=Se(g,"id",8,"country"),k=Se(g,"required",8,!1),N=Se(g,"disabled",8,!1),q=Se(g,"placeholder",8,"Select a country");const G=Object.entries(Ca).sort((E,y)=>E[1].localeCompare(y[1]));St();var T=Ta();b(()=>{n(),ta(()=>{h(),o(),k(),N(),q()})});var S=a(T);{var U=E=>{var y=Sa();y.value=y.__value="";var z=a(y,!0);r(y),b(()=>_(z,q())),v(E,y)},I=E=>{var y=Aa();y.value=y.__value="";var z=a(y,!0);r(y),b(()=>_(z,q())),v(E,y)};x(S,E=>{k()?E(I,!1):E(U)})}var $=l(S);la($,1,()=>G,ya,(E,y)=>{let z=()=>t(y)[0],F=()=>t(y)[1];var P=Na(),K={},te=a(P,!0);r(P),b(()=>{K!==(K=z())&&(P.value=(P.__value=z())??""),_(te,F())}),v(E,P)}),r(T),b(()=>{Rt(T,"name",h()),Rt(T,"id",o()),T.required=k(),T.disabled=N()}),na(T,n),v(p,T),Tt()}var $a=$t('<svg><path fill="currentColor" d="M5 3h16v4h-2V5H5v14h14v-2h2v4H3V3zm16 8h-2V9h-2V7h-2v2h2v2H7v2h10v2h-2v2h2v-2h2v-2h2z"></path></svg>');function za(p,g){const n=At(g,["children","$$slots","$$events","$$legacy"]);var h=$a();let o;b(()=>o=zt(h,o,{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...n})),v(p,h)}var qa=$t('<svg><path fill="currentColor" d="M17 4h2v10h-2zm0 12h-2v2h2v2h2v-2h2v-2zm-4-6h-2v10h2zm-8 2H3v2h2v6h2v-6h2v-2zm8-8h-2v2H9v2h6V6h-2zM5 4h2v6H5z"></path></svg>');function va(p,g){const n=At(g,["children","$$slots","$$events","$$legacy"]);var h=qa();let o;b(()=>o=zt(h,o,{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...n})),v(p,h)}var La=$t('<svg><path fill="currentColor" d="M4 2h14v2H4v16h2v-6h12v6h2V6h2v16H2V2zm4 18h8v-4H8zM20 6h-2V4h2zM6 6h9v4H6z"></path></svg>');function ca(p,g){const n=At(g,["children","$$slots","$$events","$$legacy"]);var h=La();let o;b(()=>o=zt(h,o,{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...n})),v(p,h)}var Ma=$t('<svg><path fill="currentColor" d="M16 2v4h6v2h-2v14H4V8H2V6h6V2zm-2 2h-4v2h4zm0 4H6v12h12V8zm-5 2h2v8H9zm6 0h-2v8h2z"></path></svg>');function ua(p,g){const n=At(g,["children","$$slots","$$events","$$legacy"]);var h=Ma();let o;b(()=>o=zt(h,o,{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",...n})),v(p,h)}var Fa=f('<p class="mb-4">Loading user data...</p>'),Ha=f('<p class="mb-4">You are not logged in. Please log in to view your profile.</p>'),Ua=f('<p class="mb-4 text-red-500"> </p>'),Ia=f('<div class="bg-green-600 p-4 mb-4"><div class="flex flex-row gap-2 items-center text-sm text-white"><!> <span> </span></div></div>'),Va=f('<div class="bg-red-700 p-4 mb-4"><div class="flex flex-row gap-2 items-center text-sm text-white"><!> <span> </span></div></div>'),ja=f('<p class="text-red-500 text-sm mt-1"> </p>'),Oa=f('<p class="text-red-500 text-sm mt-1"> </p>'),Ja=f('<p class="text-red-500 text-sm mt-1"> </p>'),Wa=f('<p class="text-red-500 text-sm mt-1"> </p>'),Ba=f('<p class="text-red-500 text-sm mt-1"> </p>'),Ya=f('<p class="text-red-500 text-sm mt-1"> </p>'),Da=f('<p class="text-red-500 text-sm mt-1"> </p>'),Ga=f('<p class="text-red-500 text-sm mt-1"> </p>'),Ka=f('<div class="bg-surface-100/50 backdrop-blur-md p-4 mb-4"><form class="space-y-4"><div class="flex flex-col gap-2"><h3 class="font-display-mono font-bold text-xl uppercase">Settings</h3> <div class="flex flex-row gap-4"><button type="submit" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-green-600 text-white cursor-pointer hover:opacity-50 disabled:opacity-50 disabled:cursor-not-allowed"><!> <span> </span></button> <button class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-gray-600 text-white cursor-pointer hover:opacity-50 disabled:opacity-50 disabled:cursor-not-allowed"><!> <span>Cancel</span></button></div></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="space-y-2 max-w-md"><h4 class="font-display-mono font-bold text-lg uppercase">User Info</h4> <div class="space-y-1"><div><label for="edit-name">Username</label> <input id="edit-name" name="name" type="text" required class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your username"/> <!></div> <div><label for="edit-website">Website</label> <input id="edit-website" name="website" type="url" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your website URL"/> <!></div> <div><label for="edit-affiliation">Affiliation</label> <input id="edit-affiliation" name="affiliation" type="text" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your affiliation"/> <!></div> <div><label for="edit-country">Country</label> <!> <!></div></div></div> <div class="space-y-2 max-w-md"><h4 class="font-display-mono font-bold text-lg uppercase">Security Settings</h4> <div class="space-y-1"><div><label for="current-password">Current Password <span class="text-red-500">*</span></label> <input id="current-password" name="current-password" type="password" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your current password"/> <!></div> <div><label for="edit-email">Email Address</label> <input id="edit-email" name="email" type="email" required class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your email address"/> <!></div> <div><label for="new-password">New Password</label> <input id="new-password" name="new-password" type="password" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Enter your new password"/> <!></div> <div><label for="confirm-new-password">Confirm New Password</label> <input id="confirm-new-password" name="confirm-new-password" type="password" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm" placeholder="Confirm your new password"/> <!></div></div></div></div></form></div>'),Qa=f('<div class="flex flex-row gap-4 mb-4"><button id="logout-button" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-red-700 text-white cursor-pointer hover:opacity-50"><!> <span>Logout</span></button> <button id="settings-button" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-white text-black cursor-pointer hover:opacity-50"><!> <span>Edit Profile</span></button></div> <!> <!> <!> <div class="space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><p class="font-semibold">Username:</p> <p> </p></div> <div><p class="font-semibold">Email:</p> <span> </span></div> <div><p class="font-semibold">Website:</p> <p> </p></div> <div><p class="font-semibold">Affiliation:</p> <p> </p></div> <div><p class="font-semibold">Country:</p> <p> </p></div></div></div>',1),Xa=f('<p class="mb-4">No user data available</p>'),Za=f('<section id="profile" class="p-4 bg-surface-100/50 backdrop-blur-md h-fit max-h-full custom-scrollbar overflow-y-auto"><details open><summary class="group select-none cursor-pointer"><h1 class="group-hover:translate-x-2 transition-all inline-flex font-display-mono font-bold text-2xl uppercase">My Profile</h1></summary> <div class="h-full mt-4"><!></div></details></section>');function Ra(p,g){Nt(g,!1);let n=Se(g,"user",12,null),h=s(null),o=s(!0),k=s(!1),N=s(!1),q=s(!1),G=s(""),T=s(""),S=s(""),U=s(""),I=s(""),$=s(""),E=s(""),y=s(""),z=s(null),F=s(null),P=s(null),K=s(null),te=s(null),fe=s(null),pe=s(null),ae=s(null),re=s(null),Q=s(null);async function Ee(){await wa(),Gt("/")}function xe(c){let L=!1;c.name&&c.name.length>0&&(e(P,c.name[0]),L=!0),c.email&&c.email.length>0&&(e(K,c.email[0]),L=!0),c.website&&c.website.length>0&&(e(te,c.website[0]),L=!0),c.affiliation&&c.affiliation.length>0&&(e(fe,c.affiliation[0]),L=!0),c.country&&c.country.length>0&&(e(pe,c.country[0]),L=!0),c.confirm&&c.confirm.length>0&&(e(ae,c.confirm[0]),L=!0),c.password&&c.password.length>0&&(e(re,c.password[0]),L=!0),L||e(z,"An unexpected error occurred")}function Qe(){xa(),n()&&(e(G,n().name||""),e($,n().email||""),e(T,n().website||""),e(S,n().affiliation||""),e(U,n().country||"")),e(I,""),e(E,""),e(y,""),e(k,!0)}function Xe(){e(k,!t(k))}function Ze(){n()&&(e(G,n().name||""),e($,n().email||""),e(T,n().website||""),e(S,n().affiliation||""),e(U,n().country||"")),e(I,""),e(E,""),e(y,""),e(z,null),e(F,null),e(P,null),e(K,null),e(te,null),e(fe,null),e(pe,null),e(ae,null),e(re,null),e(Q,null),e(k,!1)}async function Oe(){e(N,!0),e(q,!0),e(z,null),e(F,null),e(P,null),e(K,null),e(te,null),e(fe,null),e(pe,null),e(ae,null),e(re,null),e(Q,null);const c={};let L=!1,ze=!1;n()&&(t(G)!==(n().name||"")&&(c.name=t(G),L=!0),t(T)!==(n().website||"")&&(c.website=t(T),L=!0),t(S)!==(n().affiliation||"")&&(c.affiliation=t(S),L=!0),t(U)!==(n().country||"")&&(c.country=t(U),L=!0));const ge=n()&&t($)!==(n().email||""),me=t(E)||t(y);if(ge||me){if(!t(I)){e(ae,"Current password is required for security changes"),e(N,!1),e(q,!1);return}if(me){if(!t(E)){e(re,"New password is required"),e(N,!1),e(q,!1);return}if(!t(y)){e(Q,"Please confirm your new password"),e(N,!1),e(q,!1);return}if(t(E)!==t(y)){e(Q,"New passwords do not match"),e(N,!1),e(q,!1);return}c.password=t(E),ze=!0}c.confirm=t(I),ge&&(c.email=t($))}const be=ze||ge;if(!L&&!be){e(z,"No changes detected"),e(N,!1),e(q,!1);return}const vt=await Kt();Ae.ctfd.users.patchUserPrivate(c,{headers:{"CSRF-Token":vt}}).then(B=>{B.ok&&B.data.success?(n(B.data.data),be&&(e(I,""),e(E,""),e(y,"")),L&&be?e(F,"Profile and security settings updated successfully!"):L?e(F,"Profile updated successfully!"):be&&(ze&&ge?e(F,"Email and password updated successfully!"):ze?e(F,"Password changed successfully!"):e(F,"Email updated successfully!")),e(k,!1),setTimeout(()=>{e(F,null)},3e3)):B.error&&B.error.errors?xe(B.error.errors):e(z,"An unexpected error occurred")}).catch(B=>{console.error("Error saving changes:",B),B&&B.error&&B.error.errors?xe(B.error.errors):e(z,"An unexpected error occurred")}).finally(()=>{e(N,!1),e(q,!1)})}Xt(async()=>{Ae.ctfd.users.getUserPrivate().then(c=>{c.ok&&c.data.success&&n(c.data.data)}).catch(c=>{c.status===403?(_a(!1),console.warn("User is not logged in"),e(h,"You are not logged in")):(console.error("Error fetching user data:",c),e(h,"Unable to load user data"))}).finally(()=>{e(o,!1)})}),St();var Ne=Za(),Te=a(Ne),$e=l(a(Te),2),qt=a($e);{var Lt=c=>{var L=Fa();v(c,L)},Mt=(c,L)=>{{var ze=me=>{var be=Ha();v(me,be)},ge=(me,be)=>{{var vt=he=>{var qe=Ua(),Re=a(qe,!0);r(qe),b(()=>_(Re,t(h))),v(he,qe)},B=(he,qe)=>{{var Re=Le=>{var et=Qa(),i=Pt(et),m=a(i),le=a(m);za(le,{}),dt(2),r(m);var tt=l(m,2),ye=a(tt);va(ye,{}),dt(2),r(tt),r(i);var V=l(i,2);{var ct=A=>{var M=Ia(),se=a(M),R=a(se);sa(R,{class:"flex shrink-0"});var ee=l(R,2),D=a(ee,!0);r(ee),r(se),r(M),b(()=>_(D,t(F))),v(A,M)};x(V,A=>{t(F)&&A(ct)})}var yt=l(V,2);{var Me=A=>{var M=Va(),se=a(M),R=a(se);ia(R,{class:"flex shrink-0"});var ee=l(R,2),D=a(ee,!0);r(ee),r(se),r(M),b(()=>_(D,t(z))),v(A,M)};x(yt,A=>{t(z)&&A(Me)})}var Fe=l(yt,2);{var ut=A=>{var M=Ka(),se=a(M),R=a(se),ee=l(a(R),2),D=a(ee),Be=a(D);ca(Be,{});var H=l(Be,2),J=a(H,!0);r(H),r(D);var ce=l(D,2),ft=a(ce);ua(ft,{}),dt(2),r(ce),r(ee),r(R);var Ye=l(R,2),pt=a(Ye),Ct=l(a(pt),2),De=a(Ct),Ie=l(a(De),2);oe(Ie);var Ht=l(Ie,2);{var Ut=d=>{var C=ja(),W=a(C,!0);r(C),b(()=>_(W,t(P))),v(d,C)};x(Ht,d=>{t(P)&&d(Ut)})}r(De);var Ge=l(De,2),Ve=l(a(Ge),2);oe(Ve);var It=l(Ve,2);{var Vt=d=>{var C=Oa(),W=a(C,!0);r(C),b(()=>_(W,t(te))),v(d,C)};x(It,d=>{t(te)&&d(Vt)})}r(Ge);var lt=l(Ge,2),it=l(a(lt),2);oe(it);var jt=l(it,2);{var Ot=d=>{var C=Ja(),W=a(C,!0);r(C),b(()=>_(W,t(fe))),v(d,C)};x(jt,d=>{t(fe)&&d(Ot)})}r(lt);var mt=l(lt,2),bt=l(a(mt),2);da(bt,{name:"country",id:"edit-country",get disabled(){return t(N)},placeholder:"Select your country (or leave blank)",get value(){return t(U)},set value(d){e(U,d)},$$legacy:!0});var _t=l(bt,2);{var st=d=>{var C=Wa(),W=a(C,!0);r(C),b(()=>_(W,t(pe))),v(d,C)};x(_t,d=>{t(pe)&&d(st)})}r(mt),r(Ct),r(pt);var Et=l(pt,2),kt=l(a(Et),2),Ke=a(kt),je=l(a(Ke),2);oe(je);var Jt=l(je,2);{var Wt=d=>{var C=Ba(),W=a(C,!0);r(C),b(()=>_(W,t(ae))),v(d,C)};x(Jt,d=>{t(ae)&&d(Wt)})}r(Ke);var ot=l(Ke,2),Pe=l(a(ot),2);oe(Pe);var Bt=l(Pe,2);{var Yt=d=>{var C=Ya(),W=a(C,!0);r(C),b(()=>_(W,t(K))),v(d,C)};x(Bt,d=>{t(K)&&d(Yt)})}r(ot);var wt=l(ot,2),xt=l(a(wt),2);oe(xt);var Dt=l(xt,2);{var u=d=>{var C=Da(),W=a(C,!0);r(C),b(()=>_(W,t(re))),v(d,C)};x(Dt,d=>{t(re)&&d(u)})}r(wt);var w=l(wt,2),O=l(a(w),2);oe(O);var gt=l(O,2);{var nt=d=>{var C=Ga(),W=a(C,!0);r(C),b(()=>_(W,t(Q))),v(d,C)};x(gt,d=>{t(Q)&&d(nt)})}r(w),r(kt),r(Et),r(Ye),r(se),r(M),b(()=>{D.disabled=t(N)||t(q),_(J,t(N)||t(q)?"Saving...":"Save Changes"),ce.disabled=t(N)||t(q)}),ue("click",D,Oe),ue("click",ce,Ze),ne(Ie,()=>t(G),d=>e(G,d)),ne(Ve,()=>t(T),d=>e(T,d)),ne(it,()=>t(S),d=>e(S,d)),ne(je,()=>t(I),d=>e(I,d)),ne(Pe,()=>t($),d=>e($,d)),ne(xt,()=>t(E),d=>e(E,d)),ne(O,()=>t(y),d=>e(y,d)),ue("submit",se,Qt(Oe)),v(A,M)};x(Fe,A=>{t(k)&&A(ut)})}var at=l(Fe,2),_e=a(at),X=a(_e),de=l(a(X),2),ve=a(de,!0);r(de),r(X);var Ce=l(X,2),we=l(a(Ce),2),Je=a(we,!0);r(we),r(Ce);var He=l(Ce,2),We=l(a(He),2),rt=a(We,!0);r(We),r(He);var ke=l(He,2),Ue=l(a(ke),2),j=a(Ue,!0);r(Ue),r(ke);var Y=l(ke,2),ie=l(a(Y),2),Z=a(ie,!0);r(ie),r(Y),r(_e),r(at),b(()=>{_(ve,n().name||"N/A"),_(Je,n().email||"N/A"),_(rt,n().website||"N/A"),_(j,n().affiliation||"N/A"),_(Z,n().country||"N/A")}),ue("click",m,()=>Ee()),ue("click",tt,function(...A){(t(k)?Xe:Qe)?.apply(this,A)}),v(Le,et)},Ft=Le=>{var et=Xa();v(Le,et)};x(he,Le=>{n()?Le(Re):Le(Ft,!1)},qe)}};x(me,he=>{t(h)?he(vt):he(B,!1)},be)}};x(c,me=>{Ae.isLoggedIn===!1?me(ze):me(ge,!1)},L)}};x(qt,c=>{t(o)?c(Lt):c(Mt,!1)})}r($e),r(Te),r(Ne),v(p,Ne),Tt()}var er=f('<p class="mb-4">Loading team data...</p>'),tr=f('<p class="mb-4 text-red-500"> </p>'),ar=f('<p class="text-lg">You are not enlisted in a crew!</p> <div class="flex flex-row gap-4"><button class="px-4 py-2 bg-white text-surface-000 hover:opacity-50 cursor-pointer font-mono font-bold text-lg uppercase">Join Crew</button> <button class="px-4 py-2 bg-white text-surface-000 hover:opacity-50 cursor-pointer font-mono font-bold text-lg uppercase">Create Crew</button></div>',1),rr=f('<div class="bg-red-700 p-3 text-white text-sm"> </div>'),lr=f('<p class="text-red-500 text-sm mt-1"> </p>'),ir=f('<p class="text-red-500 text-sm mt-1"> </p>'),sr=f('<div class="w-full max-w-md space-y-4"><h1 class="font-display-mono font-bold text-xl uppercase text-center"> </h1> <p class="text-md text-center">Or <button class="underline hover:opacity-70 font-semibold"> </button> a crew instead</p> <!> <form class="space-y-4"><div><label for="crew-name" class="block text-sm font-medium mb-1">Crew Name</label> <input id="crew-name" name="crew-name" type="text" required class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter crew name"/> <!></div> <div><label for="crew-password" class="block text-sm font-medium mb-1">Crew Password</label> <input id="crew-password" name="crew-password" type="password" required class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter crew password"/> <!></div> <div class="flex flex-row gap-4 justify-center"><button type="submit" class="px-4 py-2 bg-white text-surface-000 hover:opacity-50 cursor-pointer font-mono font-bold text-lg uppercase disabled:opacity-50 disabled:cursor-not-allowed"> </button> <button type="button" class="px-4 py-2 bg-gray-600 text-white hover:opacity-50 cursor-pointer font-mono font-bold text-lg uppercase disabled:opacity-50 disabled:cursor-not-allowed">Cancel</button></div></form></div>'),or=f('<div class="flex flex-col gap-4 items-center justify-center h-full pb-8"><!></div>'),nr=f('<div class="bg-green-600 p-4 mb-4"><div class="flex flex-row gap-2 items-center text-sm text-white"><!> <span> </span></div></div>'),dr=f('<div class="bg-red-700 p-4 mb-4"><div class="flex flex-row gap-2 items-center text-sm text-white"><!> <span> </span></div></div>'),vr=f('<p class="text-red-500 text-sm mt-1"> </p>'),cr=f('<p class="text-red-500 text-sm mt-1"> </p>'),ur=f('<p class="text-red-500 text-sm mt-1"> </p>'),fr=f('<p class="text-red-500 text-sm mt-1"> </p>'),pr=f('<p class="text-red-500 text-sm mt-1"> </p>'),mr=f('<p class="text-red-500 text-sm mt-1"> </p>'),br=f("<option> </option>"),_r=f("<option disabled>No members available</option>"),wr=f('<p class="text-red-500 text-sm mt-1"> </p>'),xr=f('<div class="bg-surface-100/50 backdrop-blur-md p-4 mb-4"><form class="space-y-4"><div class="flex flex-col gap-2"><h3 class="font-display-mono font-bold text-xl uppercase">Crew Settings</h3> <div class="flex flex-row gap-4"><button type="submit" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-green-600 text-white cursor-pointer hover:opacity-50 disabled:opacity-50 disabled:cursor-not-allowed"><!> <span> </span></button> <button type="button" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-gray-600 text-white cursor-pointer hover:opacity-50 disabled:opacity-50 disabled:cursor-not-allowed"><!> <span>Cancel</span></button></div></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><div class="space-y-2 max-w-md"><h4 class="font-display-mono font-bold text-lg uppercase">Crew Info</h4> <div class="space-y-1"><div><label for="edit-crew-name">Crew Name</label> <input id="edit-crew-name" name="crew-name" type="text" required class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter crew name"/> <!></div> <div><label for="edit-crew-website">Website</label> <input id="edit-crew-website" name="website" type="url" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter crew website URL"/> <!></div> <div><label for="edit-crew-affiliation">Affiliation</label> <input id="edit-crew-affiliation" name="affiliation" type="text" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter crew affiliation"/> <!></div> <div><label for="edit-crew-country">Country</label> <!> <!></div></div></div> <div class="space-y-2 max-w-md"><h4 class="font-display-mono font-bold text-lg uppercase">Security Settings</h4> <div class="space-y-1"><div><label for="current-team-password">Current Crew Password <span class="text-red-500">*</span></label> <input id="current-team-password" name="current-team-password" type="password" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter current crew password"/> <!></div> <div><label for="new-team-password">New Crew Password</label> <input id="new-team-password" name="new-team-password" type="password" class="block w-full mt-1 border border-surface-300 px-3 py-2 text-sm disabled:opacity-50" placeholder="Enter new crew password"/> <!></div> <div><label for="edit-crew-captain">Captain</label> <select id="edit-crew-captain" name="captain" class="block w-full mt-1 border bg-surface-100 text-white border-surface-300 px-3 py-2 text-sm disabled:opacity-50"><!></select> <!></div></div></div></div></form></div>'),gr=f('<div class="flex flex-row gap-4 mb-4"><button title="Only the team captain can edit the crew" class="flex flex-row items-center gap-2 font-mono font-bold text-lg uppercase px-3 py-1 bg-white text-black hover:opacity-50 disabled:!opacity-50 cursor-pointer disabled:!cursor-not-allowed"><!> <span>Edit Crew</span></button></div> <!> <!> <!> <!>',1),hr=f('<p class="mb-4">No team data available</p>'),yr=f('<section id="crew" class="p-4 bg-surface-100/50 backdrop-blur-md h-fit max-h-full custom-scrollbar overflow-y-auto"><details open><summary class="group select-none cursor-pointer"><h1 class="group-hover:translate-x-2 transition-all inline-flex font-display-mono font-bold text-2xl uppercase">My Crew</h1></summary> <div class="h-full mt-4"><!></div></details></section>');function Cr(p,g){Nt(g,!1);const n=s();let h=Se(g,"user",8,null),o=Se(g,"team",12,null),k=s(null),N=s(null),q=s(!0),G=s(!1),T=s(null),S=s(null),U=s(!1),I=s(""),$=s(""),E=s(null),y=s(null),z=s(null),F=s(!1),P=s(!1),K=s(""),te=s(""),fe=s(""),pe=s(""),ae=s(null),re=s(""),Q=s(""),Ee=s(null),xe=s(null),Qe=s(null),Xe=s(null),Ze=s(null),Oe=s(null),Ne=s(null),Te=s(null),$e=s(null);function qt(){e(S,"join"),e(I,""),e($,""),c()}function Lt(){e(S,"create"),e(I,""),e($,""),c()}function Mt(){e(S,t(S)==="join"?"create":"join"),e(I,""),e($,""),c()}function c(){e(E,null),e(y,null),e(z,null)}function L(){o()&&(e(K,o().name||""),e(te,o().website||""),e(fe,o().affiliation||""),e(pe,o().country||""),e(ae,o().captain_id||null)),e(re,""),e(Q,""),ge(),e(F,!0)}function ze(){e(re,""),e(Q,""),e(F,!1),ge()}function ge(){e(Ee,null),e(xe,null),e(Qe,null),e(Xe,null),e(Ze,null),e(Oe,null),e(Ne,null),e(Te,null),e($e,null)}function me(i){let m=!1;i.name&&i.name.length>0&&(e(y,i.name[0]),m=!0),i.password&&i.password.length>0&&(e(z,i.password[0]),m=!0),m||e(E,"An unexpected error occurred")}function be(i){let m=!1;i.name&&i.name.length>0&&(e(Qe,i.name[0]),m=!0),i.website&&i.website.length>0&&(e(Xe,i.website[0]),m=!0),i.affiliation&&i.affiliation.length>0&&(e(Ze,i.affiliation[0]),m=!0),i.country&&i.country.length>0&&(e(Oe,i.country[0]),m=!0),i.captain_id&&i.captain_id.length>0&&(e(Ne,i.captain_id[0]),m=!0),i.confirm&&i.confirm.length>0&&(e(Te,i.confirm[0]),m=!0),i.password&&i.password.length>0&&(e($e,i.password[0]),m=!0),m||e(Ee,"An unexpected error occurred")}async function vt(){if(!t(S))return;if(e(U,!0),c(),!t(I).trim()){e(y,"Crew name is required"),e(U,!1);return}if(!t($).trim()){e(z,"Crew password is required"),e(U,!1);return}const i=await Kt();Ae.ctfd.teams.postTeamPrivate({method:t(S),name:t(I).trim(),password:t($).trim()},{headers:{"CSRF-Token":i}}).then(m=>{m.ok&&m.data.success?(e(S,null),e(I,""),e($,""),c(),Ae.ctfd.teams.getTeamPrivate().then(le=>{le.ok&&le.data.success&&(e(G,!0),o(le.data.data))}).catch(le=>{console.error("Error fetching updated team data:",le),e(N,"Unable to load updated team data")})):m.error&&m.error.errors?me(m.error.errors):e(E,"Failed to "+t(S)+" crew")}).catch(m=>{console.error("Error submitting form:",m),m.error&&m.error.errors?me(m.error.errors):e(E,"An unexpected error occurred")}).finally(()=>{e(U,!1)})}async function B(){if(!o())return;e(P,!0),ge();const i={};let m=!1,le=!1;if(t(K)!==(o().name||"")&&(i.name=t(K),m=!0),t(te)!==(o().website||"")&&(i.website=t(te),m=!0),t(fe)!==(o().affiliation||"")&&(i.affiliation=t(fe),m=!0),t(pe)!==(o().country||"")&&(i.country=t(pe),m=!0),t(ae)&&t(ae)!==o().captain_id&&(i.captain_id=t(ae),m=!0),t(Q)){if(!t(re)){e(Te,"Current password is required to change crew password"),e(P,!1);return}if(!t(Q)){e($e,"New password is required"),e(P,!1);return}i.password=t(Q),i.confirm=t(re),le=!0,m=!0}if(!m){e(Ee,"No changes detected"),e(P,!1);return}const ye=await Kt();Ae.ctfd.teams.patchTeamPrivate(i,{headers:{"CSRF-Token":ye}}).then(V=>{V.ok&&V.data.success?(o(V.data.data),le&&(e(re,""),e(Q,"")),le&&(t(K)!==(o().name||"")||t(te)!==(o().website||"")||t(fe)!==(o().affiliation||"")||t(pe)!==(o().country||""))?e(xe,"Crew settings and password updated successfully!"):le?e(xe,"Crew password updated successfully!"):e(xe,"Crew settings updated successfully!"),e(F,!1),setTimeout(()=>{e(xe,null)},3e3)):V.error&&V.error.errors?be(V.error.errors):e(Ee,"Failed to update crew settings")}).catch(V=>{console.error("Error saving crew settings:",V),V.error&&V.error.errors?be(V.error.errors):e(Ee,"An unexpected error occurred")}).finally(()=>{e(P,!1),e(T,new Date().toISOString())})}Xt(async()=>{Ae.ctfd.teams.getTeamPrivate().then(i=>{i.ok&&i.data.success&&(e(G,!0),o(i.data.data))}).catch(i=>{i.status===403?e(G,!1):(console.error("Error fetching team data:",i),e(N,"Unable to load team"))}).finally(()=>{e(q,!1)})}),aa(()=>(Zt(h()),Zt(o())),()=>{e(n,h()?.id===o()?.captain_id)}),ra(),St();var he=yr(),qe=a(he),Re=l(a(qe),2),Ft=a(Re);{var Le=i=>{var m=er();v(i,m)},et=(i,m)=>{{var le=ye=>{var V=tr(),ct=a(V,!0);r(V),b(()=>_(ct,t(N))),v(ye,V)},tt=(ye,V)=>{{var ct=Me=>{var Fe=or(),ut=a(Fe);{var at=X=>{var de=ar(),ve=l(Pt(de),2),Ce=a(ve),we=l(Ce,2);r(ve),ue("click",Ce,qt),ue("click",we,Lt),v(X,de)},_e=X=>{var de=sr(),ve=a(de),Ce=a(ve,!0);r(ve);var we=l(ve,2),Je=l(a(we)),He=a(Je,!0);r(Je),dt(),r(we);var We=l(we,2);{var rt=H=>{var J=rr(),ce=a(J,!0);r(J),b(()=>_(ce,t(E))),v(H,J)};x(We,H=>{t(E)&&H(rt)})}var ke=l(We,2),Ue=a(ke),j=l(a(Ue),2);oe(j);var Y=l(j,2);{var ie=H=>{var J=lr(),ce=a(J,!0);r(J),b(()=>_(ce,t(y))),v(H,J)};x(Y,H=>{t(y)&&H(ie)})}r(Ue);var Z=l(Ue,2),A=l(a(Z),2);oe(A);var M=l(A,2);{var se=H=>{var J=ir(),ce=a(J,!0);r(J),b(()=>_(ce,t(z))),v(H,J)};x(M,H=>{t(z)&&H(se)})}r(Z);var R=l(Z,2),ee=a(R),D=a(ee,!0);r(ee);var Be=l(ee,2);r(R),r(ke),r(de),b(()=>{_(Ce,t(S)==="join"?"Join Crew":"Create Crew"),_(He,t(S)==="join"?"create":"join"),j.disabled=t(U),A.disabled=t(U),ee.disabled=t(U),_(D,t(U)?"Submitting...":t(S)==="join"?"Join Crew":"Create Crew"),Be.disabled=t(U)}),ue("click",Je,Mt),ne(j,()=>t(I),H=>e(I,H)),ne(A,()=>t($),H=>e($,H)),ue("click",Be,()=>e(S,null)),ue("submit",ke,Qt(vt)),v(X,de)};x(ut,X=>{t(S)===null?X(at):X(_e,!1)})}r(Fe),v(Me,Fe)},yt=(Me,Fe)=>{{var ut=_e=>{var X=gr(),de=Pt(X),ve=a(de),Ce=a(ve);va(Ce,{}),dt(2),r(ve),r(de);var we=l(de,2);{var Je=j=>{var Y=nr(),ie=a(Y),Z=a(ie);sa(Z,{class:"w-5 h-5"});var A=l(Z,2),M=a(A,!0);r(A),r(ie),r(Y),b(()=>_(M,t(xe))),v(j,Y)};x(we,j=>{t(xe)&&j(Je)})}var He=l(we,2);{var We=j=>{var Y=dr(),ie=a(Y),Z=a(ie);ia(Z,{class:"w-5 h-5"});var A=l(Z,2),M=a(A,!0);r(A),r(ie),r(Y),b(()=>_(M,t(Ee))),v(j,Y)};x(He,j=>{t(Ee)&&j(We)})}var rt=l(He,2);{var ke=j=>{var Y=xr(),ie=a(Y),Z=a(ie),A=l(a(Z),2),M=a(A),se=a(M);ca(se,{});var R=l(se,2),ee=a(R,!0);r(R),r(M);var D=l(M,2),Be=a(D);ua(Be,{}),dt(2),r(D),r(A),r(Z);var H=l(Z,2),J=a(H),ce=l(a(J),2),ft=a(ce),Ye=l(a(ft),2);oe(Ye);var pt=l(Ye,2);{var Ct=u=>{var w=vr(),O=a(w,!0);r(w),b(()=>_(O,t(Qe))),v(u,w)};x(pt,u=>{t(Qe)&&u(Ct)})}r(ft);var De=l(ft,2),Ie=l(a(De),2);oe(Ie);var Ht=l(Ie,2);{var Ut=u=>{var w=cr(),O=a(w,!0);r(w),b(()=>_(O,t(Xe))),v(u,w)};x(Ht,u=>{t(Xe)&&u(Ut)})}r(De);var Ge=l(De,2),Ve=l(a(Ge),2);oe(Ve);var It=l(Ve,2);{var Vt=u=>{var w=ur(),O=a(w,!0);r(w),b(()=>_(O,t(Ze))),v(u,w)};x(It,u=>{t(Ze)&&u(Vt)})}r(Ge);var lt=l(Ge,2),it=l(a(lt),2);da(it,{name:"country",id:"edit-crew-country",get disabled(){return t(P)},placeholder:"Select crew country (or leave blank)",get value(){return t(pe)},set value(u){e(pe,u)},$$legacy:!0});var jt=l(it,2);{var Ot=u=>{var w=fr(),O=a(w,!0);r(w),b(()=>_(O,t(Oe))),v(u,w)};x(jt,u=>{t(Oe)&&u(Ot)})}r(lt),r(ce),r(J);var mt=l(J,2),bt=l(a(mt),2),_t=a(bt),st=l(a(_t),2);oe(st);var Et=l(st,2);{var kt=u=>{var w=pr(),O=a(w,!0);r(w),b(()=>_(O,t(Te))),v(u,w)};x(Et,u=>{t(Te)&&u(kt)})}r(_t);var Ke=l(_t,2),je=l(a(Ke),2);oe(je);var Jt=l(je,2);{var Wt=u=>{var w=mr(),O=a(w,!0);r(w),b(()=>_(O,t($e))),v(u,w)};x(Jt,u=>{t($e)&&u(Wt)})}r(Ke);var ot=l(Ke,2),Pe=l(a(ot),2);b(()=>{t(ae),ta(()=>{t(P),t(k),o()})});var Bt=a(Pe);{var Yt=u=>{var w=ba(),O=Pt(w);la(O,1,()=>t(k),gt=>gt.id,(gt,nt)=>{var d=br(),C={},W=a(d,!0);r(d),b(()=>{C!==(C=t(nt).id)&&(d.value=(d.__value=t(nt).id)??""),ga(d,t(nt).id===o().captain_id),_(W,t(nt).name)}),v(gt,d)}),v(u,w)},wt=u=>{var w=_r();w.value=w.__value="",v(u,w)};x(Bt,u=>{t(k)&&t(k).length>0?u(Yt):u(wt,!1)})}r(Pe);var xt=l(Pe,2);{var Dt=u=>{var w=wr(),O=a(w,!0);r(w),b(()=>_(O,t(Ne))),v(u,w)};x(xt,u=>{t(Ne)&&u(Dt)})}r(ot),r(bt),r(mt),r(H),r(ie),r(Y),b(()=>{M.disabled=t(P),_(ee,t(P)?"Saving...":"Save Changes"),D.disabled=t(P),Ye.disabled=t(P),Ie.disabled=t(P),Ve.disabled=t(P),st.disabled=t(P),je.disabled=t(P),Pe.disabled=t(P)||!t(k)||t(k).length===0}),ue("click",D,ze),ne(Ye,()=>t(K),u=>e(K,u)),ne(Ie,()=>t(te),u=>e(te,u)),ne(Ve,()=>t(fe),u=>e(fe,u)),ne(st,()=>t(re),u=>e(re,u)),ne(je,()=>t(Q),u=>e(Q,u)),na(Pe,()=>t(ae),u=>e(ae,u)),ue("submit",ie,Qt(B)),v(j,Y)};x(rt,j=>{t(F)&&j(ke)})}var Ue=l(rt,2);Ea(Ue,{get teamId(){return o().id},get lastUpdated(){return t(T)},get teamMembers(){return t(k)},set teamMembers(j){e(k,j)},$$legacy:!0}),b(()=>ve.disabled=!t(n)),ue("click",ve,L),v(_e,X)},at=_e=>{var X=hr();v(_e,X)};x(Me,_e=>{o()?_e(ut):_e(at,!1)},Fe)}};x(ye,Me=>{t(G)?Me(yt,!1):Me(ct)},V)}};x(i,ye=>{t(N)?ye(le):ye(tt,!1)},m)}};x(Ft,i=>{t(q)?i(Le):i(et,!1)})}r(Re),r(qe),r(he),v(p,he),Tt()}var Er=f('<div class="panel"><p>Loading profile...</p></div>'),kr=f('<div class="flex flex-col xl:grid xl:grid-cols-2 grow gap-4 h-full font-mono"><!> <!></div>'),Pr=f('<div class="panel"><p>You must be logged in to view this page. <a href="/login" class="underline hover:bg-text hover:text-surface-000">Go to Login</a></p></div>'),Sr=f('<div class="flex flex-col grow gap-4 h-full font-mono"><!></div>');function Gr(p,g){Nt(g,!1);let n=s(!0),h=s(null),o=s(null);Xt(()=>{e(n,!1)}),aa(()=>Gt,()=>{!Ae.isLoggedIn&&typeof window<"u"&&Gt("/login")}),ra(),St();var k=Sr(),N=a(k);{var q=T=>{var S=Er();v(T,S)},G=(T,S)=>{{var U=$=>{var E=kr(),y=a(E);Ra(y,{get user(){return t(h)},set user(F){e(h,F)},$$legacy:!0});var z=l(y,2);Cr(z,{get user(){return t(h)},get team(){return t(o)},set team(F){e(o,F)},$$legacy:!0}),r(E),v($,E)},I=$=>{var E=Pr();v($,E)};x(T,$=>{Ae.isLoggedIn?$(U):$(I,!1)},S)}};x(N,T=>{t(n)?T(q):T(G,!1)})}r(k),v(p,k),Tt()}export{Gr as default};
